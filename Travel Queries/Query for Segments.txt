SELECT FLT.PNR,
FLT.PSN_NR, 
FLT.TVR_ID, 
FLT.REL_ID, 
FLT.ORG_CTY, 
FLT.DST_CTY, 
FLT.CABIN, 
FLT.PRI_CD, 
FLT.FLT_DT, 
FLT.BUS_PER_IND, 
FLT.FLT_MLS, 
FLT.LST_NM, 
FLT.SVC_CHG, 
FLT.TOT_CHG,
FLT.NET_TXBL_VAL, 
FLT.EMP_CO_ID, 
FLT.CUR_PVG_ID, 
FLT.CC_PAID_IND, 
PSN.CST_DFN_STS_ID
FROM AAPROD.ATDR022A_FLTSEG AS FLT LEFT JOIN AAPROD.ATDR001A_PERSON AS PSN ON FLT.PSN_NR = PSN.PSN_NR
WHERE FLT.FLT_DT BETWEEN ADD_DAYS(ADD_MONTHS(THIS_MONTH(NOW()),-1) AND ADD_DAYS(THIS_MONTH(NOW()),-1);

//////Historical Data (Run the below code only if neccessary) ;

SELECT FLT.PNR,
FLT.PSN_NR, 
FLT.TVR_ID, 
FLT.REL_ID, 
FLT.ORG_CTY, 
FLT.DST_CTY, 
FLT.CABIN, 
FLT.PRI_CD, 
FLT.FLT_DT, 
FLT.BUS_PER_IND, 
FLT.FLT_MLS, 
FLT.LST_NM, 
FLT.SVC_CHG, 
FLT.TOT_CHG,
FLT.NET_TXBL_VAL, 
FLT.EMP_CO_ID, 
FLT.CUR_PVG_ID, 
FLT.CC_PAID_IND, 
PSN.CST_DFN_STS_ID
FROM AAPROD.ATDR034A_FLTSEG_H AS FLT LEFT JOIN AAPROD.ATDR001A_PERSON AS PSN ON FLT.PSN_NR = PSN.PSN_NR
WHERE FLT.FLT_DT BETWEEN '01/01/2021' AND '02/28/2021';